export interface MalwareSignature {
  id: string;
  name: string;
  type: 'hash' | 'pattern' | 'behavior' | 'network';
  signature: string;
  severity: 'critical' | 'high' | 'medium' | 'low';
  description: string;
  source: 'internal' | 'clamav' | 'virustotal' | 'custom';
  lastUpdated: string;
  isActive: boolean;
  falsePositiveRate: number;
  detectionCount: number;
}

export interface MalwareDetection {
  id: string;
  timestamp: string;
  sourceIP: string;
  targetIP?: string;
  malwareType: 'virus' | 'trojan' | 'worm' | 'ransomware' | 'spyware' | 'adware' | 'rootkit' | 'botnet';
  signatureId: string;
  signatureName: string;
  severity: 'critical' | 'high' | 'medium' | 'low';
  confidence: number;
  status: 'detected' | 'quarantined' | 'cleaned' | 'false_positive';
  affectedFiles: string[];
  networkTraffic: {
    protocol: string;
    port: number;
    bytes: number;
    packets: number;
  };
  hashValues: {
    md5?: string;
    sha1?: string;
    sha256?: string;
  };
  mitigationActions: string[];
  isAIRelated: boolean;
}

export interface HeuristicAnalysis {
  id: string;
  timestamp: string;
  entityId: string;
  entityType: 'file' | 'process' | 'network_flow' | 'endpoint';
  suspiciousActivities: string[];
  riskScore: number;
  behaviorPatterns: {
    fileOperations: number;
    networkConnections: number;
    registryChanges: number;
    processCreations: number;
  };
  aiModelPrediction: {
    isMalicious: boolean;
    confidence: number;
    modelVersion: string;
  };
  recommendedActions: string[];
}

export interface ExternalThreatIntel {
  id: string;
  source: 'virustotal' | 'clamav' | 'malwarebytes' | 'crowdstrike' | 'custom';
  lastSync: string;
  signatureCount: number;
  status: 'active' | 'syncing' | 'error' | 'disabled';
  apiKey?: string;
  syncInterval: number; // minutes
  errorMessage?: string;
}

export interface MalwareMetrics {
  totalDetections: number;
  activeThreats: number;
  quarantinedItems: number;
  cleanedItems: number;
  falsePositives: number;
  detectionsByType: Record<string, number>;
  detectionsBySeverity: Record<string, number>;
  signatureDatabase: {
    totalSignatures: number;
    lastUpdated: string;
    sources: ExternalThreatIntel[];
  };
  heuristicEngine: {
    analysisCount: number;
    accuracy: number;
    averageRiskScore: number;
  };
  recentDetections: MalwareDetection[];
  heuristicAnalyses: HeuristicAnalysis[];
}